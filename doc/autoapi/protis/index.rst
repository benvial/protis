protis
======

.. py:module:: protis

.. autoapi-nested-parse::

   This module implements the protis API.



Classes
-------

.. autoapisummary::

   protis.Simulation
   protis.Lattice


Package Contents
----------------

.. py:class:: Simulation(lattice, k=(0, 0), epsilon=1, mu=1, nh=100)

   .. py:attribute:: lattice


   .. py:attribute:: k
      :value: (0, 0)



   .. py:attribute:: epsilon
      :value: 1



   .. py:attribute:: mu
      :value: 1



   .. py:attribute:: nh0
      :value: 100



   .. py:property:: kx


   .. py:property:: ky


   .. py:property:: Kx


   .. py:property:: Ky


   .. py:method:: build_epsilon_hat()


   .. py:method:: build_mu_hat()


   .. py:method:: build_A(polarization)


   .. py:method:: build_B(polarization)


   .. py:method:: solve(polarization, vectors=True, rbme=None, return_square=False, sparse=False, neig=10, ktol=1e-12, reduced=False, **kwargs)


   .. py:method:: get_rbme_matrix(N_RBME, bands_RBME, polarization)


   .. py:method:: unit_cell_integ(u)


   .. py:method:: phasor()


   .. py:method:: get_chi(polarization)


   .. py:method:: get_xi(polarization)


   .. py:method:: build_Cs(phi0, polarization)


   .. py:method:: normalization(mode, polarization)


   .. py:method:: coeff2mode(coeff)


   .. py:method:: get_mode(imode)


   .. py:method:: get_modes(imodes)


   .. py:method:: scalar_product_real(u, v)


   .. py:method:: scalar_product_fourier(u, v)


   .. py:method:: scalar_product_rbme(u, v)


   .. py:method:: plot(field, nper=1, ax=None, cmap='RdBu_r', show_cell=False, cellstyle='-k', **kwargs)


   .. py:method:: get_hfh_tensor(imode, polarization)


   .. py:method:: get_berry_curvature(kx, ky, eigenmode, method='fourier')


   .. py:method:: get_chern_number(kx, ky, berry_curvature)


.. py:class:: Lattice(basis_vectors, discretization=(2**8, 2**8), truncation='circular', harmonics_array=None)

   Bases: :py:obj:`nannos.Lattice`


   A lattice object defining the unit cell.

   :param basis_vectors: The lattice vectors :math:`((u_x,u_y),(v_x,v_y))`.
                         For mono-periodic gratings, specify the x-periodicity with a float `a`.
   :type basis_vectors: tuple
   :param discretization: Spatial discretization of the lattice. If given an integer N, the
                          discretization will be (N, N).
   :type discretization: int or tuple of length 2
   :param truncation: The truncation method, available values are "circular" and "parallelogrammic" (the default is "circular").
                      This has no effect for mono-periodic gratings.
   :type truncation: str
   :param harmonics_array: Array of harmonics. If specified, this is used instead of harmonics generated by
                           the lattice object and nh is deduced from it.
   :type harmonics_array: array of shape (2, nh)


